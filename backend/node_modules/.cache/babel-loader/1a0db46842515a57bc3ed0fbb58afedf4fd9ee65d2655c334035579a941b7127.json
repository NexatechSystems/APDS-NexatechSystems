{"ast":null,"code":"import React,{useState}from\"react\";import DOMPurify from'dompurify';// For XSS prevention\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const Register=props=>{const[name,setName]=useState('');const[idNumber,setIdNumber]=useState('');const[accountNumber,setAccountNumber]=useState('');const[pass,setPass]=useState('');const handleSubmit=async e=>{e.preventDefault();// Prepend 'cust' to the account number\nconst fullAccountNumber=`cust${accountNumber}`;// Send the registration request\nconst response=await fetch('https://localhost:3001/api/users/register',{method:'POST',headers:{'Content-Type':'application/json'},credentials:'include',// Ensure cookies are included in the request\nbody:JSON.stringify({fullName:name,idNumber,accountNumber:fullAccountNumber,password:pass})});const data=await response.text();if(response.status===201){alert('Registration successful!');props.onFormSwitch('login');}else{alert('Registration failed. Please try again.');}console.log(data);};// Validate input patterns\nconst handleNameChange=e=>{const value=e.target.value;if(/^[a-zA-Z\\s]*$/.test(value)){// Allow only letters and spaces\nsetName(value);}};const handleIdNumberChange=e=>{const value=e.target.value;if(/^\\d{0,13}$/.test(value)){// Allow only up to 13 digits\nsetIdNumber(value);}};const handleAccountNumberChange=e=>{const value=e.target.value;if(/^\\d{0,4}$/.test(value)){// Allow only up to 4 digits\nsetAccountNumber(value);}};const handlePasswordChange=e=>{const value=e.target.value;if(/^[A-Za-z\\d]{0,16}$/.test(value)){// Allows letters and numbers, up to 16 characters\nsetPass(value);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"auth-form-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Register\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"register-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"name\",children:\"Full Name\"}),/*#__PURE__*/_jsx(\"input\",{value:DOMPurify.sanitize(name)// Sanitize the input to prevent XSS\n,onChange:handleNameChange,name:\"name\",id:\"name\",placeholder:\"John Doe\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"idNumber\",children:\"ID Number\"}),/*#__PURE__*/_jsx(\"input\",{value:idNumber,onChange:handleIdNumberChange,type:\"text\",placeholder:\"Your ID Number\",id:\"idNumber\",name:\"idNumber\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"accountNumber\",children:\"Account Number\"}),/*#__PURE__*/_jsx(\"input\",{value:accountNumber,onChange:handleAccountNumberChange,type:\"text\",placeholder:\"Account Number (e.g 0000)\",id:\"accountNumber\",name:\"accountNumber\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{value:pass,onChange:handlePasswordChange,type:\"password\",placeholder:\"***********\",id:\"password\",name:\"password\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Register\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"link-btn\",onClick:()=>props.onFormSwitch('login'),children:\"Already have an account? Log In\"})]});};","map":{"version":3,"names":["React","useState","DOMPurify","jsx","_jsx","jsxs","_jsxs","Register","props","name","setName","idNumber","setIdNumber","accountNumber","setAccountNumber","pass","setPass","handleSubmit","e","preventDefault","fullAccountNumber","response","fetch","method","headers","credentials","body","JSON","stringify","fullName","password","data","text","status","alert","onFormSwitch","console","log","handleNameChange","value","target","test","handleIdNumberChange","handleAccountNumberChange","handlePasswordChange","className","children","onSubmit","htmlFor","sanitize","onChange","id","placeholder","type","onClick"],"sources":["C:/Users/hoque/payments-portal/src/frontend/Register.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport DOMPurify from 'dompurify';  // For XSS prevention\r\n\r\nexport const Register = (props) => {\r\n    const [name, setName] = useState('');\r\n    const [idNumber, setIdNumber] = useState('');\r\n    const [accountNumber, setAccountNumber] = useState('');\r\n    const [pass, setPass] = useState('');\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        \r\n        // Prepend 'cust' to the account number\r\n        const fullAccountNumber = `cust${accountNumber}`;\r\n\r\n        // Send the registration request\r\n        const response = await fetch('https://localhost:3001/api/users/register', \r\n        {\r\n            method: 'POST',\r\n            headers: \r\n            {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            credentials: 'include', // Ensure cookies are included in the request\r\n            body: JSON.stringify({ fullName: name, idNumber, accountNumber: fullAccountNumber, password: pass }),\r\n        });\r\n\r\n        const data = await response.text();\r\n        if (response.status === 201) \r\n        {\r\n            alert('Registration successful!');\r\n            props.onFormSwitch('login');\r\n        } \r\n        else \r\n        {\r\n            alert('Registration failed. Please try again.');\r\n        }\r\n        console.log(data);\r\n    };    \r\n\r\n    // Validate input patterns\r\n    const handleNameChange = (e) => {\r\n        const value = e.target.value;\r\n        if (/^[a-zA-Z\\s]*$/.test(value)) { // Allow only letters and spaces\r\n            setName(value);\r\n        }\r\n    };\r\n\r\n    const handleIdNumberChange = (e) => {\r\n        const value = e.target.value;\r\n        if (/^\\d{0,13}$/.test(value)) { // Allow only up to 13 digits\r\n            setIdNumber(value);\r\n        }\r\n    };\r\n\r\n    const handleAccountNumberChange = (e) => {\r\n        const value = e.target.value;\r\n        if (/^\\d{0,4}$/.test(value)) { // Allow only up to 4 digits\r\n            setAccountNumber(value);\r\n        }\r\n    };\r\n\r\n    const handlePasswordChange = (e) => {\r\n        const value = e.target.value;\r\n        if (/^[A-Za-z\\d]{0,16}$/.test(value)) { // Allows letters and numbers, up to 16 characters\r\n            setPass(value);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"auth-form-container\">\r\n            <h2>Register</h2>\r\n            <form className=\"register-form\" onSubmit={handleSubmit}>\r\n                <label htmlFor=\"name\">Full Name</label>\r\n                <input\r\n                    value={DOMPurify.sanitize(name)} // Sanitize the input to prevent XSS\r\n                    onChange={handleNameChange}\r\n                    name=\"name\"\r\n                    id=\"name\"\r\n                    placeholder=\"John Doe\"\r\n                />\r\n                <label htmlFor=\"idNumber\">ID Number</label>\r\n                <input\r\n                    value={idNumber} \r\n                    onChange={handleIdNumberChange}\r\n                    type=\"text\"\r\n                    placeholder=\"Your ID Number\"\r\n                    id=\"idNumber\"\r\n                    name=\"idNumber\"\r\n                />\r\n                <label htmlFor=\"accountNumber\">Account Number</label>\r\n                <input\r\n                    value={accountNumber} \r\n                    onChange={handleAccountNumberChange}\r\n                    type=\"text\"\r\n                    placeholder=\"Account Number (e.g 0000)\"\r\n                    id=\"accountNumber\"\r\n                    name=\"accountNumber\"\r\n                />\r\n                <label htmlFor=\"password\">Password</label>\r\n                <input\r\n                    value={pass}\r\n                    onChange={handlePasswordChange}\r\n                    type=\"password\"\r\n                    placeholder=\"***********\"\r\n                    id=\"password\"\r\n                    name=\"password\"\r\n                />\r\n                <button type=\"submit\">Register</button>\r\n            </form>\r\n            <button className=\"link-btn\" onClick={() => props.onFormSwitch('login')}>\r\n                Already have an account? Log In\r\n            </button>\r\n        </div>\r\n    );\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}